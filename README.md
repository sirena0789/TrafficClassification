# Описание проекта
Компания онлайн-сервис с высоким уровнем входящего трафика имеет специализированный отдел безопасности, который занимается фильтрацией и анализом трафика. Сотрудники этого отдела обратились за помощью в автоматизации выявления аномального и злонамеренного трафика. Ваша задача - разработать модель, которая будет классифицировать трафик на нормальный и злонамеренный, включая следующие типы атак: DDoS, SQL-инъекции, брутфорс, вредоносные программы и т.д.

## Цель работы
- Разработать модель, которая будет классифицировать трафик на нормальный и злонамеренный. При этом модель должна работать максимально качественно, так как цена ошибки может быть очень высока.
- Оценить качество модели по различным метрикам классификации: precision, recall, f1_score, accuracy.
- Деплой: разработать REST API сервис, который будет принимать на вход данные трафика и возвращать класс этого трафика.

# Итоги исследования
[Ссылка на Jupyter Notebook](/traffic.ipynb)  

В данном проекте разработана модель, которая классифицирует трафик на нормальный и злонамеренный.  
Для работы использовался датасет размерностью (539616, 78).     

При выполнении проекта была проведена предобработка данных, а именно:  
- удалено 488 пропусков;
- удалено 134617 дубликатов, что состовляет 24% от всех данных.

При разведочном анализе было выявлено, что среди полей присутствуют ; столбцов, заполненных нулями, которые в последствии были удалены. Так же в данных присутствуют 27 признаков, корреляция которых с иными превосходит порог в 0.95. От них тоже пришлось избавиться.   
Данные были разделены на тестовую и тренировочную выборки, для оучения модели был сформирован пайплайн с препроцессором, содержащим функцию для стандартизации численных значений выборки. 
После обучения и тестирования был произведен анализ важности признаков, а также создан [REST API](/flask/) сервис, который принимая на вход данные трафика генерирует его класс.

**Итоговая модель:**   

- CatBoostClassifier;
- loss_function: MultiClass;
- eval_metric: Accuracy;
- iterations: 500;
- learning_rate: 0.1. 

**Результаты на тестовой выборке:**  

|                          | precision | recall | f1-score |
|--------------------------|-----------|--------|----------|
| BENIGN                   | 1.00      | 1.00   | 1.00     |
| Bot                      | 0.94      | 0.93   | 0.93     |
| DDoS                     | 1.00      | 1.00   | 1.00     |
| DoS GoldenEye            | 0.99      | 1.00   | 1.00     |
| DoS Hulk                 | 1.00      | 1.00   | 1.00     |
| DoS Slowhttptest         | 0.99      | 0.99   | 0.99     |
| DoS slowloris            | 1.00      | 0.99   | 0.99     |
| FTP-Patator              | 1.00      | 1.00   | 1.00     |
| Heartbleed               | 1.00      | 1.00   | 1.00     |
| Infiltration             | 1.00      | 0.67   | 0.80     |
| PortScan                 | 0.94      | 0.96   | 0.95     |
| SSH-Patator              | 1.00      | 1.00   | 1.00     |
| Web Attack Brute Force   | 0.72      | 0.97   | 0.83     |
| Web Attack Sql Injection | 1.00      | 0.50   | 0.67     |
| Web Attack XSS           | 0.70      | 0.16   | 0.26     |
|||||
| accuracy                 | 1.00      | 1.00   | 1.00     |
| weighted avg             | 1.00      | 1.00   | 1.00     |
| macro avg                | 0.95      | 0.88   | 0.89     |

